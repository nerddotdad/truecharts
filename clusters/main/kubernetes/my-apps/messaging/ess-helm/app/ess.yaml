apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: matrix-stack
  namespace: messaging
spec:
  interval: 5m
  chart:
    spec:
      chart: matrix-stack
      version: 0.5.0
      sourceRef:
        kind: HelmRepository
        name: element-hq
        namespace: flux-system
  values:
    components:
      - synapse
      - element-web
      - element-call

    overrides:
      synapse:
        server_name: "hoth.systems"
        public_baseurl: "https://matrix.hoth.systems"

      element-web:
        default_server_config:
          "m.homeserver":
            base_url: "https://matrix.hoth.systems"
            server_name: "hoth.systems"

      element-call:
        TURN:
          urls:
            - "turn:turn.hoth.systems?transport=udp"
            - "turn:turn.hoth.systems?transport=tcp"
          username: your-turn-username
          credential: your-turn-password

    global:
      ingress:
        enabled: false