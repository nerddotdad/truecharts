apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: azerothcore
  namespace: gaming
spec:
  interval: 5m
  chart:
    spec:
      chart: app-template
      version: 14.5.3
      sourceRef:
        kind: HelmRepository
        name: truecharts
        namespace: flux-system
  values:
    image:
      repository: acore/ac-wotlk-worldserver
      tag: master

    controller:
      type: deployment
      replicas: 1

    command:
      - /azerothcore/bin/worldserver

    env:
      AC_LOGIN_DATABASE_INFO: "mariadb.default.svc.cluster.local;3306;acore;acore;acore_auth"
      AC_WORLD_DATABASE_INFO: "mariadb.default.svc.cluster.local;3306;acore;acore;acore_world"
      AC_CHARACTER_DATABASE_INFO: "mariadb.default.svc.cluster.local;3306;acore;acore;acore_characters"

    persistence:
      config:
        enabled: true
        mountPath: /azerothcore/etc
        type: nfs
        server: <YOUR_NAS_IP>
        path: <YOUR_NFS_PATH>

    mariadb:
      enabled: false

    service:
      main:
        enabled: true
        ports:
          main:
            port: 8085
            targetPort: 8085
