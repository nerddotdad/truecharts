apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: wow-mariadb
  namespace: gaming
spec:
  interval: 5m
  chart:
    spec:
      chart: mariadb
      version: 15.9.0  # adjust to your desired version
      sourceRef:
        kind: HelmRepository
        name: truecharts
        namespace: flux-system
  values:
    auth:
      rootPassword: "${WOW_PASS}"
      password: "${WOW_PASS}"
      username: ac_user
      database: acore_auth   # primary db for the user, rest created by init.sql
    primary:
      service:
        nameOverride: wow-mariadb
        port: 3306
    persistence:
      enabled: true
      size: 8Gi
    extraVolumes:
      - name: init-sql
        configMap:
          name: azerothcore-init-sql
    extraVolumeMounts:
      - name: init-sql
        mountPath: /docker-entrypoint-initdb.d/init.sql
        subPath: init.sql
